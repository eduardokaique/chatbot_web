import{a as E,j as y,l as $,r as i,L as j,R as k,b as I}from"./vendor.7ce79383.js";const B=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))_(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&_(o)}).observe(document,{childList:!0,subtree:!0});function h(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function _(t){if(t.ep)return;t.ep=!0;const a=h(t);fetch(t.href,a)}};B();const z="_contentWrapper_luj2b_1";var A={contentWrapper:z};const m=E.create({baseURL:"https://chatbot-api-ifsp.herokuapp.com/"}),L="_container_na39h_1",W="_panel_na39h_14",O="_icon_minim_na39h_37",D="_msg_container_base_na39h_41",R="_msg_receive_na39h_57",T="_msg_sent_na39h_62",X="_messages_na39h_67",H="_msg_container_na39h_41",P="_avatar_na39h_96",U="_base_receive_na39h_100",q="_base_sent_na39h_112",G="_dropup_na39h_151",F="_btnMinimize_na39h_157",K="_panelCustom_na39h_163",Q="_spaceBetweenMessage_na39h_167";var v={container:L,"col-md-2":"_col-md-2_na39h_10","col-md-10":"_col-md-10_na39h_10",panel:W,"chat-window":"_chat-window_na39h_18","chat-window2":"_chat-window2_na39h_33",icon_minim:O,msg_container_base:D,"top-bar":"_top-bar_na39h_49",msg_receive:R,msg_sent:T,messages:X,msg_container:H,avatar:P,base_receive:U,base_sent:q,"btn-group":"_btn-group_na39h_151",dropup:G,btnMinimize:F,panelCustom:K,spaceBetweenMessage:Q},V="/assets/avatar_cliente.be7a2c1e.png";const e=y.exports.jsx,r=y.exports.jsxs;function J(){const p=[],n=new Date;$("http://localhost:4000").on("new_message",s=>{p.push(s)});const[_,t]=i.exports.useState(!1),[a,o]=i.exports.useState([]),[d,l]=i.exports.useState([]),[u,x]=i.exports.useState(""),[b,M]=i.exports.useState(),[c,N]=i.exports.useState();i.exports.useEffect(()=>{setTimeout(()=>{N({id:null,texto:"Bem vindo ao atendimento da empresa XXXXX. Selecione a op\xE7\xE3o desejada:",autor:`Bot \u2022 ${n.getHours()}:${n.getMinutes()}`,avatar_url:"/src/assets/user-profile1.jpeg"})},2e3)},[]),i.exports.useEffect(()=>{setTimeout(()=>{m.get("menus").then(s=>{l(s.data)})},2e3)},[]),i.exports.useEffect(()=>{setInterval(()=>{p.length>0&&o(p)},1e3)},[]);async function C(s,f){s.preventDefault();let w=d.filter(g=>g.id==f&&g.grupoAtendimentoId!=null);if(M(w[0]),w.some(g=>g))N({id:null,texto:"Voc\xEA ser\xE1 transferido para o atendimento especializado... Aguarde",autor:`Bot \u2022 ${n.getHours()}:${n.getMinutes()}`,avatar_url:"/src/assets/user-profile1.jpeg"}),l([]);else{const g=await m.post("submenus",{parentMenuId:f});l(g.data)}}async function S(s){!u.trim()||(s.preventDefault(),await m.post("messages",{mensagem:u,grupoAtendimentoId:b==null?void 0:b.grupoAtendimentoId}),x(""),t(!0))}return e("div",{className:v.container,children:e("div",{className:"col-md-3",children:e("div",{className:"col-xs-12",children:e("form",{onSubmit:S,children:r("div",{className:`panel panel-default ${v.panelCustom}`,children:[r("div",{className:`panel-heading ${v.btnMinimize}`,children:[e("div",{className:"col-xs-8",children:r("h2",{className:"panel-title",children:[e("span",{className:"glyphicon glyphicon-comment"})," Atendimento ao Cliente"]})}),e("div",{children:e("a",{href:"#",children:e("span",{id:"minim_chat_window",className:"glyphicon glyphicon-minus icon_minim"})})})]}),r("div",{className:"panel-body msg_container_base",children:[r("div",{className:"row msg_container base_sent }",children:[e("div",{className:"col-md-10 col-xs-10",children:r("div",{className:`rmessages msg_sent ${v.spaceBetweenMessage}}`,children:[e(j,{type:"ThreeDots",color:"black",height:30,width:30,timeout:2e3}),e("p",{children:c==null?void 0:c.texto}),d.map(s=>e("div",{children:r("a",{onClick:f=>C(f,s.id),children:[s.opcao," - ",s.descricao]})},s.id)),e("time",{dateTime:n.toString(),children:c==null?void 0:c.autor})]})}),e("div",{className:"col-md-2 col-xs-2 avatar",children:e("img",{src:c==null?void 0:c.avatar_url,className:"img-responsive "})})]}),_?a.map(s=>r("div",{className:"row msg_container base_receive",children:[e("div",{className:"col-md-2 col-xs-2 avatar",children:e("img",{src:V,className:" img-responsive "})}),e("div",{className:"col-md-10 col-xs-10",children:r("div",{className:"messages msg_receive",children:[e("p",{children:s.texto}),r("time",{dateTime:`${n.getHours()}:${n.getMinutes()}`,children:["Cliente \u2022 ",`${n.getHours()}:${n.getMinutes()}`]})]})})]})):e("div",{})]}),e("div",{className:"panel-footer",children:r("div",{className:"input-group",children:[e("input",{value:u,onChange:s=>x(s.target.value),id:"btn-input",type:"text",className:"form-control input-sm chat_input",placeholder:"Escreva sua mensagem aqui..."}),e("span",{className:"input-group-btn",children:e("button",{type:"submit",className:"btn btn-primary btn-sm",id:"btn-chat",children:"Enviar"})})]})})]})})})})})}function Y(){return e("main",{className:A.contentWrapper,children:e(J,{})})}const Z=i.exports.createContext({});function ee(p){const[n,h]=i.exports.useState(null),_="https://github.com/login/oauth/authorize?scope=user&client_id=0847d1ae83d144ae07b0";async function t(o){const d=await m.post("authenticate",{code:o}),{token:l,user:u}=d.data;localStorage.setItem("@doWhile:token",l),m.defaults.headers.common.authorization=`Bearer ${l}`,h(u)}function a(){h(null),localStorage.removeItem("@doWhile:token")}return i.exports.useEffect(()=>{const o=localStorage.getItem("@doWhile:token");o&&(m.defaults.headers.common.authorization=`Bearer ${o}`,m.get("profile").then(d=>{h(d.data)}))},[]),i.exports.useEffect(()=>{const o=window.location.href;if(o.includes("?code=")){const[l,u]=o.split("?code=");window.history.pushState({},"",l),t(u)}},[]),e(Z.Provider,{value:{signInUrl:_,user:n,signOut:a},children:p.children})}k.render(e(I.StrictMode,{children:e(ee,{children:e(Y,{})})}),document.getElementById("root"));
